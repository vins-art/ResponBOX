<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>RESPON BOX - SAW DEMO</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    :root {
        --primary: #6da8ff;
        --primary-dark: #4d8df5;
        --bg: #f4f7ff;
        --card: #ffffff;
        --text: #2c3e50;
        --border: #dce6ff;
    }

    body {
        margin: 0;
        font-family: "Segoe UI", sans-serif;
        background: var(--bg);
    }

    /* NAVBAR */
    .navbar {
        background: var(--primary);
        color: white;
        padding: 14px 30px;
        font-size: 18px;
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: sticky;
        top: 0;
        z-index: 10;
    }

    .logoutBtn {
        background: #ff6b6b;
        border: none;
        padding: 6px 16px;
        border-radius: 6px;
        color: white;
        cursor: pointer;
        font-weight: 600;
        display: none;
    }

    /* LAYOUT */
    .page {
        max-width: 900px;
        margin: 40px auto;
        background: var(--card);
        padding: 30px;
        border-radius: 14px;
        box-shadow: 0 3px 12px rgba(0,0,0,0.07);
    }

    h2 {
        color: var(--primary-dark);
        margin-top: 0;
    }

    input, select, textarea {
        width: 100%;
        padding: 12px;
        border: 1px solid var(--border);
        border-radius: 8px;
        margin-top: 4px;
        margin-bottom: 18px;
        font-size: 15px;
        background: #f9fbff;
    }

    button {
        background: var(--primary);
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        font-size: 15px;
    }

    button:hover {
        background: var(--primary-dark);
    }

    /* TABLE */
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
    }

    th, td {
        border-bottom: 1px solid var(--border);
        padding: 12px;
        text-align: left;
    }

    th {
        background: #eef4ff;
        color: var(--primary-dark);
    }

    /* CARDS */
    .card-row {
        display: flex;
        gap: 15px;
        margin: 20px 0;
    }
    .card {
        flex: 1;
        background: #f9fbff;
        padding: 20px;
        border-radius: 10px;
        border: 1px solid var(--border);
        text-align: center;
        font-size: 16px;
        font-weight: 600;
    }
    .card b {
        display: block;
        font-size: 26px;
        margin-top: 8px;
        color: var(--primary-dark);
    }

    .hidden { display: none; }

</style>
</head>
<body>

<!-- NAVBAR -->
<div class="navbar">
    RESPON BOX â€” SAW
    <button id="logoutBtn" class="logoutBtn" onclick="logout()">Logout</button>
</div>

<!-- LOGIN PAGE -->
<div id="loginPage" class="page">
    <h2>Login</h2>
    <label>Username (NIM atau NIDN/NUPTK)</label>
    <input id="loginUser">

    <label>Password</label>
    <input type="password" id="loginPass">

    <button onclick="login()">Login</button>

    <br><br>
    <p>Belum punya akun mahasiswa?</p>
    <button onclick="showPage('regPage')">Registrasi Mahasiswa</button>
</div>


<!-- REGISTRASI -->
<div id="regPage" class="page hidden">
    <h2>Registrasi Mahasiswa</h2>

    <label>Nama Lengkap</label>
    <input id="regNama">

    <label>NIM</label>
    <input id="regNim">

    <label>Kelas</label>
    <input id="regKelas">

    <label>Tempat, Tanggal Lahir</label>
    <input id="regTTL">

    <label>Password</label>
    <input type="password" id="regPass">

    <button onclick="registerMahasiswa()">Daftar</button>
    <button onclick="showPage('loginPage')">Kembali</button>
</div>



<!-- MAHASISWA DASHBOARD -->
<div id="mahasiswaDashboard" class="page hidden">
    <h2 id="mhsGreeting"></h2>
    <p id="mhsNimDisplay"></p>

    <hr><br>

    <h3>Buat Laporan Baru</h3>

    <label>Judul Laporan</label>
    <input id="lapJudul">

    <label>Kategori</label>
    <select id="lapKategori">
        <option>Kerusakan Fasilitas</option>
        <option>Kebersihan</option>
        <option>Administrasi</option>
    </select>

    <label>Deskripsi Laporan</label>
    <textarea id="lapDeskripsi"></textarea>

    <button onclick="buatLaporan()">Kirim Laporan</button>

    <br><br><hr><br>

    <h3>Riwayat Laporan</h3>
    <table id="tableMhs">
        <tr>
            <th>Judul</th>
            <th>Kategori</th>
            <th>Status</th>
        </tr>
    </table>
</div>



<!-- ADMIN DASHBOARD -->
<div id="adminDashboard" class="page hidden">
    <h2>Dashboard Admin</h2>

    <div class="card-row">
        <div class="card">Baru<b id="admBaru">0</b></div>
        <div class="card">Diproses<b id="admProses">0</b></div>
        <div class="card">Selesai<b id="admDone">0</b></div>
    </div>

    <h3>Semua Laporan</h3>
    <table id="adminTable">
        <tr>
            <th>Pelapor</th>
            <th>Judul</th>
            <th>Kategori</th>
            <th>Status</th>
        </tr>
    </table>
</div>



<!-- PIMPINAN DASHBOARD -->
<div id="pimpinanDashboard" class="page hidden">
    <h2>Dashboard Pimpinan</h2>

    <div class="card-row">
        <div class="card">Total<b id="pTotal">0</b></div>
        <div class="card">Baru<b id="pBaru">0</b></div>
        <div class="card">Diproses<b id="pProses">0</b></div>
        <div class="card">Selesai<b id="pSelesai">0</b></div>
    </div>

    <br>
    <h3>Tren Kerusakan (30 Hari)</h3>
    <div class="card">[Diagram Dummy]</div>

    <br>
    <h3>Rekap Kategori Terbanyak</h3>
    <div class="card">[Rekap Dummy]</div>
</div>



<script>
/* Navigation */
function showPage(id){
    document.querySelectorAll(".page").forEach(p => p.classList.add("hidden"));
    document.getElementById(id).classList.remove("hidden");

    document.getElementById("logoutBtn").style.display =
        (id === "loginPage" || id === "regPage") ? "none" : "inline-block";
}


/* Registrasi */
function registerMahasiswa(){
    const list = JSON.parse(localStorage.getItem("mahasiswaList")) || [];

    const data = {
        nama: regNama.value,
        nim: regNim.value,
        kelas: regKelas.value,
        ttl: regTTL.value,
        password: regPass.value
    };

    list.push(data);
    localStorage.setItem("mahasiswaList", JSON.stringify(list));

    alert("Registrasi Berhasil!");
    showPage("loginPage");
}


/* LOGIN */
function login(){
    const user = loginUser.value.trim();
    const pass = loginPass.value.trim();

    const admin = { user:"admin", pass:"admin123", role:"admin" };
    const pimpinan = { user:"pimpinan", pass:"pimpinan123", role:"pimpinan" };

    if(user === admin.user && pass === admin.pass){
        localStorage.setItem("loggedUser", JSON.stringify(admin));
        showAdmin();
        return;
    }

    if(user === pimpinan.user && pass === pimpinan.pass){
        localStorage.setItem("loggedUser", JSON.stringify(pimpinan));
        showPimpinan();
        return;
    }

    const list = JSON.parse(localStorage.getItem("mahasiswaList")) || [];
    const mhs = list.find(m => m.nim === user && m.password === pass);

    if(mhs){
        localStorage.setItem("loggedUser", JSON.stringify({
            role:"mahasiswa",
            nama:mhs.nama,
            nim:mhs.nim
        }));
        showMahasiswa(mhs);
        return;
    }

    alert("Login gagal.");
}


/* MAHASISWA */
function showMahasiswa(m){
    mhsGreeting.textContent = "Halo, " + m.nama;
    mhsNimDisplay.textContent = "NIM: " + m.nim;
    loadMhsLaporan(m.nim);
    showPage("mahasiswaDashboard");
}

function buatLaporan(){
    const list = JSON.parse(localStorage.getItem("laporanList")) || [];
    const user = JSON.parse(localStorage.getItem("loggedUser"));

    const anon = user.nim.substring(0,6) + "******";

    list.push({
        nim:user.nim,
        anon,
        judul: lapJudul.value,
        kategori: lapKategori.value,
        deskripsi: lapDeskripsi.value,
        status: "Baru"
    });

    localStorage.setItem("laporanList", JSON.stringify(list));
    alert("Laporan terkirim!");
    loadMhsLaporan(user.nim);
}

function loadMhsLaporan(nim){
    const list = JSON.parse(localStorage.getItem("laporanList")) || [];
    tableMhs.innerHTML = `
        <tr><th>Judul</th><th>Kategori</th><th>Status</th></tr>
    `;

    list.filter(l => l.nim===nim).forEach(l=>{
        tableMhs.innerHTML += `
            <tr>
                <td>${l.judul}</td>
                <td>${l.kategori}</td>
                <td>${l.status}</td>
            </tr>
        `;
    });
}


/* ADMIN */
function showAdmin(){
    loadAdmin();
    showPage("adminDashboard");
}

function loadAdmin(){
    const list = JSON.parse(localStorage.getItem("laporanList")) || [];

    admBaru.textContent = list.filter(l => l.status=="Baru").length;
    admProses.textContent = list.filter(l => l.status=="Proses").length;
    admDone.textContent = list.filter(l => l.status=="Selesai").length;

    adminTable.innerHTML = `
        <tr>
            <th>Pelapor</th>
            <th>Judul</th>
            <th>Kategori</th>
            <th>Status</th>
        </tr>
    `;

    list.forEach(l=>{
        adminTable.innerHTML += `
        <tr>
            <td>${l.anon}</td>
            <td>${l.judul}</td>
            <td>${l.kategori}</td>
            <td>${l.status}</td>
        </tr>`;
    });
}


/* PIMPINAN */
function showPimpinan(){
    const list = JSON.parse(localStorage.getItem("laporanList")) || [];

    pTotal.textContent = list.length;
    pBaru.textContent = list.filter(l=>l.status=="Baru").length;
    pProses.textContent = list.filter(l=>l.status=="Proses").length;
    pSelesai.textContent = list.filter(l=>l.status=="Selesai").length;

    showPage("pimpinanDashboard");
}


/* LOGOUT */
function logout(){
    localStorage.removeItem("loggedUser");
    showPage("loginPage");
}

</script>

</body>
</html>
